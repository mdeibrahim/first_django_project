{% extends 'dashboard/dashboard.html' %}
{% block title %} Admin Dashboard {% endblock title %}
{% block tasks %}
<div class="bg-white rounded-xl shadow-sm">

  <div class="grid grid-cols-4 gap-2 p-4  text-sm text-gray-500 font-medium">
    <div class="col-span-1 ">TASK</div> {# Combined Status and Title #}
    <div class="col-span-1 text-center ">STATUS</div>
    <div class="col-span-1 text-center  flex justify-between px-4">
        <div>PRIORITY</div>
        <div class="text-left">TEAM</div>
    </div>
    <div class="col-span-1 text-center ">CREATED</div>
  </div>

  <div class="divide-y divide-gray-100">
    {% for task in tasks %}
    <div class="grid grid-cols-4 gap-2 p-4 items-center hover:bg-gray-50 transition-colors">
      <div class="col-span-1 flex items-center space-x-3"> {# Increased space-x for better separation #}
        <div class="flex-shrink-0 w-3 h-3 rounded-full {% if task.status == 'COMPLETED' %}bg-green-500{% elif task.status == 'IN_PROGRESS' %}bg-yellow-500{% else %}bg-orange-500{% endif %}"></div>
        <div>
          <span class="text-gray-800 font-medium">{{ task.title }}</span>
        </div>
      </div>

      <div class="col-span-1 text-center">
        {% if task.details %}
        <span class="px-3 py-1 rounded-full text-xs font-semibold
          {% if task.details.priority == 'H' %}bg-red-100 text-red-700
          {% elif task.details.priority == 'M' %}bg-yellow-100 text-yellow-700
          {% else %}bg-blue-100 text-blue-700{% endif %}">
          {% comment %} {% endcomment %}
           {{task.status}}
        </span>
        {% else %}
        <span class="px-3 py-1 rounded-full bg-gray-100 text-gray-500 text-xs font-semibold">Not Set</span>
        {% endif %}
      </div>

      <div class="col-span-1 text-center flex justify-between px-4">
        <div>{{ task.details.get_priority_display }} </div>
        <div class="col-span-1 flex -space-x-2 justify-center">
          {% for employee in task.assigned_to.all %}
          <div class="w-8 h-8 rounded-full bg-blue-500 flex items-center justify-center text-white text-xs border-2 border-white ring-1 ring-white" title="{{ employee.name }}">
            {{ employee.name|slice:":1"|upper }}{% if employee.name|length > 1 %}{{ employee.name|slice:"1:2"|lower }}{% endif %} {# Displaying first initial capitalized, second lower if exists #}
          </div>
          {% empty %}
          <div class="text-gray-400 text-xs italic">No team</div>
          {% endfor %}
        </div>
    </div>


      

      <div class="col-span-1 text-gray-500 text-sm text-center">{{ task.created_at|timesince }} ago</div>
    </div>
    {% empty %}
    <div class="p-6 text-center text-gray-500">
      No tasks found.
    </div>
    {% endfor %}
  </div>
</div>
{% endblock tasks %}
